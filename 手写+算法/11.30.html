<!--
 * @Author: Ying Zhang
 * @Date: 2021-11-30 10:39:40
 * @LastEditTime: 2021-11-30 15:17:57
 * @LastEditors: Ying Zhang
 * @Description: 
 * @FilePath: /每日一题/11.30.html
 * 道阻且长，行则将至
-->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body></body>
  <script>
    // 算法题：https://leetcode-cn.com/problems/linked-list-cycle-ii/
    // 142. 环形链表 II
    /**
     * Definition for singly-linked list.
     * function ListNode(val) {
     *     this.val = val;
     *     this.next = null;
     * }
     */

    /**
     * @param {ListNode} head
     * @return {ListNode}
     */
    var detectCycle = function (head) {};

    // 手写题：https://bigfrontend.dev/zh/problem/implement-Promise-any
    // 34. 实现`Promise.any()`
    // 参考地址：https://juejin.cn/post/6965596525388890142

    /**
     * @param {Array<Promise>} promises
     * @return {Promise}
     */
    function any(promises) {
      // your code here
      return new Promise((resolve, reject) => {
        promises = Array.isArray(promises) ? promises : [];
        let length = promises.length;
        let errs = [];
        let isFulfilled = false;
        if (length === 0) {
          return reject(
            new AggregateError("No Promise in Promise.any was resolved", "拒绝")
          );
        }
        promises.forEach((promise, index) => {
          promise.then(
            (value) => {
              if (!isFulfilled) {
                resolve(value);
                isFulfilled = true;
              }
            },
            (err) => {
              errs[index] = err;
              length--;
              // errs.push(err);
              if (length === 0) {
                reject(
                  new AggregateError(
                    "No Promise in Promise.any was resolved",
                    errs
                  )
                );
              }
            }
          );
        });
      });
    }

    any([Promise.reject("111"), Promise.reject("222")])
      .then((value) => {
        console.log("value", value);
      })
      .catch((err) => {
        console.log("err", err);
      });
  </script>
</html>
